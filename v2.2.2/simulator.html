
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>NengoDL Simulator &#8212; NengoDL 2.2.2 docs</title>
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i,600|Rajdhani:700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.nengo.ai/css/bootstrap.css" type="text/css">
<style>
  body .title-bar,
  body .documentation-source h1:after {
    background-color: #ff6600;
  }
</style>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GT8XEDLTMJ"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-GT8XEDLTMJ');
</script>
<!-- End Google tag (gtag.js) -->

<!-- Matomo -->
<script>
 var _paq = window._paq = window._paq || [];
 _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
 _paq.push(["setCookieDomain", "*.appliedbrainresearch.com"]);
 _paq.push(["setDomains", ["*.appliedbrainresearch.com","*.edge.nengo.ai","*.forum.nengo.ai","*.labs.nengo.ai","*.nengo.ai"]]);
 _paq.push(["enableCrossDomainLinking"]);
 _paq.push(["setDoNotTrack", true]);
 _paq.push(['trackPageView']);
 _paq.push(['enableLinkTracking']);
 (function() {
   var u="https://appliedbrainresearch.matomo.cloud/";
   _paq.push(['setTrackerUrl', u+'matomo.php']);
   _paq.push(['setSiteId', '3']);
   var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
   g.async=true; g.src='//cdn.matomo.cloud/appliedbrainresearch.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
 })();
</script>
<!-- End Matomo Code -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<!-- From basic/layout.html -->
<script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
  
  
<script type="text/javascript" src="_static/underscore.js"></script>
  
  
<script type="text/javascript" src="_static/doctools.js"></script>
  
  
<script type="text/javascript" src="_static/language_data.js"></script>
  
  
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
  
  
<script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Optimizing a NengoDL model" href="training.html" />
    <link rel="prev" title="User guide" href="user-guide.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  </head><body class="bg-dark">

<header class="fixed-top header-top shadow-sm">
  <nav class="navbar navbar-expand-md navbar-light bg-white">
    <a class="navbar-brand" href="https://www.nengo.ai/">
      <img
        src="https://www.nengo.ai/design/_images/general-full-light.svg"
        alt="Nengo"
        class="logo"
      />
    </a>
    <button
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbar-collapse"
      aria-controls="navbar-collapse"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/">What is Nengo?</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/examples/">Examples</a>
        </li>
        <li class="nav-item dropdown active">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-docs"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Documentation</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-docs"
          >
            
            <a class="dropdown-item" href="https://www.nengo.ai/nengo/">Nengo Core</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-gui/">Nengo GUI</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-dl/">Nengo DL</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-spa/">Nengo SPA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-extras/">Nengo Extras</a>
            <a class="dropdown-item" href="https://arvoelke.github.io/nengolib-docs/">Nengolib</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-fpga/">Nengo FPGA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-loihi/">Nengo Loihi</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-ocl">Nengo OpenCL</a>
            <a class="dropdown-item" href="https://github.com/project-rig/nengo_spinnaker">Nengo SpiNNaker</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-mpi">Nengo MPI</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/documentation/"
              >All documentation</a
            >
          </div>
        </li>
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-community"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Community</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-community"
          >
            <a class="dropdown-item" href="https://forum.nengo.ai">Forum</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/people/"
              >People</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/summer-school/"
              >Summer school</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/contributing/"
              >Contributing</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/publications/"
              >Publications</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/videos/"
              >Videos</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/conduct/"
              >Code of conduct</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/caa/">CAA</a>
          </div>
        </li>
        <li class="nav-item">
          <a
            class="nav-link btn btn-success btn-sm text-white"
            href="https://www.nengo.ai/getting-started/"
            >Getting started</a
          >
        </li>
      </ul>
    </div>
  </nav>
</header>
<div class="main-content gradient-top">
  <div class="container-fluid">
    <div class="row"><a class="toggle-sidenav d-block d-md-none" href="#"
  ><i class="icon-close fa fa-fw fa-arrow-left"></i
  ><i class="icon-open fa fa-fw fa-arrow-right"></i
></a>
<div role="complementary" class="sidenav col-4 col-xl-3 p-0 border-right">
  <h3 class="pt-5 px-5">
    <a href="index.html">
      <img
        class="img-fluid documentation-image"
        src="https://www.nengo.ai/design/_images/nengo-dl-full-light.svg"
        alt="NengoDL"
      />
    </a>
  </h3>
  
  <form class="px-5 pb-5 mb-0 mt-3 border-bottom">
    <div class="form-group">
      <label class="text-gray">Version:</label>
      <select class="custom-select" onchange="switchVersion(this);">
        
        
        <option value="../simulator.html">latest</option>
        
        
          
        <option selected>v2.2.2</option>
          
        
          
        <option value="../v2.2.1/simulator.html">
          v2.2.1
        </option>
          
        
          
        <option value="../v2.2.0/simulator.html">
          v2.2.0
        </option>
          
        
          
        <option value="../v2.1.1/simulator.html">
          v2.1.1
        </option>
          
        
          
        <option value="../v2.1.0/simulator.html">
          v2.1.0
        </option>
          
        
          
        <option value="../v2.0.0/simulator.html">
          v2.0.0
        </option>
          
        
          
        <option value="../v1.2.1/simulator.html">
          v1.2.1
        </option>
          
        
          
        <option value="../v1.2.0/simulator.html">
          v1.2.0
        </option>
          
        
          
        <option value="../v1.1.0/simulator.html">
          v1.1.0
        </option>
          
        
          
        <option value="../v1.0.0/simulator.html">
          v1.0.0
        </option>
          
        
          
        <option value="../v0.6.2/simulator.html">
          v0.6.2
        </option>
          
        
          
        <option value="../v0.6.1/simulator.html">
          v0.6.1
        </option>
          
        
          
        <option value="../v0.6.0/simulator.html">
          v0.6.0
        </option>
          
        
          
        <option value="../v0.5.2/simulator.html">
          v0.5.2
        </option>
          
        
          
        <option value="../v0.5.1/simulator.html">
          v0.5.1
        </option>
          
        
          
        <option value="../v0.5.0/simulator.html">
          v0.5.0
        </option>
          
        
          
        <option value="../v0.4.0/simulator.html">
          v0.4.0
        </option>
          
        
          
        <option value="../v0.3.1/simulator.html">
          v0.3.1
        </option>
          
        
          
        <option value="../v0.3.0/simulator.html">
          v0.3.0
        </option>
          
        
          
        <option value="../v0.2.0/simulator.html">
          v0.2.0
        </option>
          
        
      </select>
    </div>
  </form>
  
  <div class="p-5 toctree">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user-guide.html">User guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">NengoDL Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simulator-arguments">Simulator arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simulator-run-arguments">Simulator.run arguments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="training.html">Optimizing a NengoDL model</a></li>
<li class="toctree-l2"><a class="reference internal" href="tensor-node.html">TensorNodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Configuration options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Additional resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project information</a></li>
</ul>

  </div>
<form class="p-5 my-0 border-top" action="search.html" method="get">
  <div class="form-group form-group-single">
    <input type="text" name="q" class="form-control" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <button type="submit" class="btn btn-link">
      <img src="https://www.nengo.ai/img/icon-search.svg" alt="Go" />
    </button>
  </div>
</form></div>
      

      <div class="col-12 col-md-8 col-xl-9">
        <div class="container">
          <div class="row">
            <div class="col-10 offset-1 pb-5 documentation-source" role="main">
              
  <div class="section" id="nengodl-simulator">
<h1>NengoDL Simulator<a class="headerlink" href="#nengodl-simulator" title="Permalink to this headline">¶</a></h1>
<p>This is the class that allows users to access the <code class="docutils literal notranslate"><span class="pre">nengo_dl</span></code>
backend.  This can be used as a drop-in replacement for <code class="docutils literal notranslate"><span class="pre">nengo.Simulator</span></code>
(i.e., simply replace any instance of <code class="docutils literal notranslate"><span class="pre">nengo.Simulator</span></code> with
<code class="docutils literal notranslate"><span class="pre">nengo_dl.Simulator</span></code> and everything will continue to function as
normal).</p>
<p>In addition, the Simulator exposes features unique to the
NengoDL backend, such as <a class="reference internal" href="reference.html#nengo_dl.simulator.Simulator.train" title="nengo_dl.simulator.Simulator.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator.train</span></code></a>.</p>
<p>The full class documentation can be viewed in the
<a class="reference internal" href="reference.html#sim-api"><span class="std std-ref">API Reference</span></a>; here we will explain the practical usage of
the Simulator in more depth.</p>
<div class="section" id="simulator-arguments">
<h2>Simulator arguments<a class="headerlink" href="#simulator-arguments" title="Permalink to this headline">¶</a></h2>
<p>The NengoDL <a class="reference internal" href="reference.html#nengo_dl.simulator.Simulator" title="nengo_dl.simulator.Simulator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator</span></code></a> has a number of optional arguments, beyond
those in <a class="reference external" href="https://www.nengo.ai/nengo/backend-api.html#nengo.Simulator" title="(in Nengo v3.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nengo.Simulator</span></code></a>, which control features specific to
the <code class="docutils literal notranslate"><span class="pre">nengo_dl</span></code> backend.</p>
<div class="section" id="device">
<h3>device<a class="headerlink" href="#device" title="Permalink to this headline">¶</a></h3>
<p>This specifies the computational device on which the simulation will
run.  The default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, which means that operations will be assigned
according to TensorFlow’s internal logic (generally speaking, this means that
things will be assigned to the GPU if <code class="docutils literal notranslate"><span class="pre">tensorflow-gpu</span></code> is installed,
otherwise everything will be assigned to the CPU).  The device can be set
manually by passing the <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Graph#device">TensorFlow device specification</a> to this
parameter.  For example, setting <code class="docutils literal notranslate"><span class="pre">device=&quot;/cpu:0&quot;</span></code> will force everything
to run on the CPU.  This may be worthwhile for small models, where the extra
overhead of communicating with the GPU outweighs the actual computations.  On
systems with multiple GPUs, <code class="docutils literal notranslate"><span class="pre">device=&quot;/gpu:0&quot;</span></code>/<code class="docutils literal notranslate"><span class="pre">&quot;/gpu:1&quot;</span></code>/etc. will select
which one to use.</p>
</div>
<div class="section" id="unroll-simulation">
<h3>unroll_simulation<a class="headerlink" href="#unroll-simulation" title="Permalink to this headline">¶</a></h3>
<p>This controls how many simulation iterations are executed each time through
the outer simulation loop.  That is, we could run 20 timesteps as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="o">&lt;</span><span class="n">run</span> <span class="mi">1</span> <span class="n">step</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="o">&lt;</span><span class="n">run</span> <span class="mi">1</span> <span class="n">step</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">run</span> <span class="mi">1</span> <span class="n">step</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">run</span> <span class="mi">1</span> <span class="n">step</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">run</span> <span class="mi">1</span> <span class="n">step</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This is an optimization process known as “loop unrolling”, and
<code class="docutils literal notranslate"><span class="pre">unroll_simulation</span></code> controls how many simulation steps are unrolled.  The
first example above would correspond to <code class="docutils literal notranslate"><span class="pre">unroll_simulation=1</span></code>, and the
second would be <code class="docutils literal notranslate"><span class="pre">unroll_simulation=4</span></code>.</p>
<p>Unrolling the simulation will result in faster simulation speed, but increased
build time and memory usage.</p>
<p>In general, unrolling the simulation will have no impact on the output of a
simulation.  The only case in which unrolling may have an impact is if
the number of simulation steps is not evenly divisible by
<code class="docutils literal notranslate"><span class="pre">unroll_simulation</span></code>.  In that case extra simulation steps will be executed,
and then data will be truncated to the correct number of steps.  However, those
extra steps could still change the internal state of the simulation, which
will affect any subsequent calls to <code class="docutils literal notranslate"><span class="pre">sim.run</span></code>.  So it is recommended that the
number of steps always be evenly divisible by <code class="docutils literal notranslate"><span class="pre">unroll_simulation</span></code>.</p>
</div>
<div class="section" id="minibatch-size">
<span id="id1"></span><h3>minibatch_size<a class="headerlink" href="#minibatch-size" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">nengo_dl</span></code> allows a model to be simulated with multiple simultaneous inputs,
processing those values in parallel through the network.  For example, instead
of executing a model three times with three different inputs, the model can
be executed once with those three inputs in parallel.  <code class="docutils literal notranslate"><span class="pre">minibatch_size</span></code>
specifies how many inputs will be processed at a time.  The default is
<code class="docutils literal notranslate"><span class="pre">None</span></code>, meaning that this feature is not used and only one input will be
processed at a time (as in standard Nengo simulators).</p>
<p>In order to take advantage of the parallel inputs, multiple inputs need to
be passed to <a class="reference internal" href="reference.html#nengo_dl.simulator.Simulator.run" title="nengo_dl.simulator.Simulator.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator.run</span></code></a> via the <code class="docutils literal notranslate"><span class="pre">data</span></code> argument.  This
is discussed in more detail <a class="reference internal" href="#sim-run"><span class="std std-ref">below</span></a>.</p>
<p>When using <a class="reference internal" href="reference.html#nengo_dl.simulator.Simulator.train" title="nengo_dl.simulator.Simulator.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator.train</span></code></a>, this parameter controls how many items
from the training data will be used for each optimization iteration.</p>
</div>
<div class="section" id="tensorboard">
<h3>tensorboard<a class="headerlink" href="#tensorboard" title="Permalink to this headline">¶</a></h3>
<p>This can be used to specify an output directory if you would like to export
data from the simulation in a format that can be visualized in
<a class="reference external" href="https://www.tensorflow.org/guide/summaries_and_tensorboard">TensorBoard</a>.</p>
<p>To view the collected data, run the command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tensorboard --logdir &lt;tensorboard_dir&gt;
</pre></div>
</div>
<p>(where <code class="docutils literal notranslate"><span class="pre">tensorboard_dir</span></code> is the directory name passed to <code class="docutils literal notranslate"><span class="pre">tensorboard</span></code>),
then open a web browser and navigate to <a class="reference external" href="http://localhost:6006">http://localhost:6006</a>.</p>
<p>By default the TensorBoard output will only contain a <a class="reference external" href="https://www.tensorflow.org/guide/graph_viz">visualization of the
TensorFlow graph</a>
constructed for this Simulator.  However, TensorBoard can also be used to track
various aspects of the simulation throughout the training process; see
<a class="reference internal" href="training.html#summaries"><span class="std std-ref">the sim.train documentation</span></a> for details.</p>
<p>Repeated Simulator calls with the same output directory will be organized into
subfolders according to run number (e.g., <code class="docutils literal notranslate"><span class="pre">&lt;tensorboard_dir&gt;/run_0</span></code>).</p>
</div>
</div>
<div class="section" id="simulator-run-arguments">
<span id="sim-run"></span><h2>Simulator.run arguments<a class="headerlink" href="#simulator-run-arguments" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="reference.html#nengo_dl.simulator.Simulator.run" title="nengo_dl.simulator.Simulator.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator.run</span></code></a> (and its variations <a class="reference internal" href="reference.html#nengo_dl.simulator.Simulator.step" title="nengo_dl.simulator.Simulator.step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator.step</span></code></a>/
<a class="reference internal" href="reference.html#nengo_dl.simulator.Simulator.run_steps" title="nengo_dl.simulator.Simulator.run_steps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator.run_steps</span></code></a>) also have some optional parameters beyond those
in the standard Nengo simulator.</p>
<div class="section" id="data">
<h3>data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h3>
<p>This parameter can be used to override the value of any
input <a class="reference external" href="https://www.nengo.ai/nengo/frontend-api.html#nengo.Node" title="(in Nengo v3.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Node</span></code></a> in a model (an input node is defined as
a node with no incoming connections).  For example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_steps</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">net</span><span class="p">:</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo_dl</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run_steps</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)</span>
</pre></div>
</div>
<p>will execute the model in the standard way, and if we check the output of
<code class="docutils literal notranslate"><span class="pre">node</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]]</span>
</pre></div>
</div>
<p>we see that it is all zero, as defined.</p>
<p><code class="docutils literal notranslate"><span class="pre">data</span></code> is specified as a
dictionary of <code class="docutils literal notranslate"><span class="pre">{my_node:</span> <span class="pre">override_value}</span></code> pairs, where <code class="docutils literal notranslate"><span class="pre">my_node</span></code> is the
Node to be overridden and <code class="docutils literal notranslate"><span class="pre">override_value</span></code> is a numpy array with shape
<code class="docutils literal notranslate"><span class="pre">(minibatch_size,</span> <span class="pre">n_steps,</span> <span class="pre">my_node.size_out)</span></code> that gives the Node output
value on each simulation step. For example, if we instead run the model via</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">run_steps</span><span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))})</span>
<span class="k">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[[</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">1.</span><span class="p">]]</span>
</pre></div>
</div>
<p>we see that the output of <code class="docutils literal notranslate"><span class="pre">node</span></code> is all ones, which is the override
value we specified.</p>
<p><code class="docutils literal notranslate"><span class="pre">data</span></code> is usually used in concert with the minibatching feature of
<code class="docutils literal notranslate"><span class="pre">nengo_dl</span></code> (<a class="reference internal" href="#minibatch-size"><span class="std std-ref">see above</span></a>).  <code class="docutils literal notranslate"><span class="pre">nengo_dl</span></code> allows multiple
inputs to be processed simultaneously, but when we construct a
<a class="reference external" href="https://www.nengo.ai/nengo/frontend-api.html#nengo.Node" title="(in Nengo v3.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Node</span></code></a> we can only specify one value.  For example, if we
use minibatching on the above network</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mini</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">with</span> <span class="n">nengo_dl</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="o">=</span><span class="n">mini</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run_steps</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[[[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]]</span>
     <span class="p">[[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]]</span>
     <span class="p">[[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]]]</span>
</pre></div>
</div>
<p>we see that the output is an array of zeros with size
<code class="docutils literal notranslate"><span class="pre">(mini,</span> <span class="pre">n_steps,</span> <span class="pre">1)</span></code>.  That is, we simulated 3 inputs
simultaneously, but those inputs all had the same value (the one we defined
when the Node was constructed) so it wasn’t very
useful.  To take full advantage of the minibatching we need to override the
node values, so that we can specify a different value for each item in the
minibatch:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">nengo_dl</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="o">=</span><span class="n">mini</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">run_steps</span><span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="n">node</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">mini</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mini</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">]})</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[[[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">]]</span>
     <span class="p">[[</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">1.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">1.</span><span class="p">]]</span>
     <span class="p">[[</span> <span class="mf">2.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">2.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">2.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">2.</span><span class="p">]</span> <span class="p">[</span> <span class="mf">2.</span><span class="p">]]]</span>
</pre></div>
</div>
<p>Here we can see that 3 independent inputs have been processed during the
simulation. In a simple network such as this, minibatching will not make much
difference. But for larger models it will be much more efficient to process
multiple inputs in parallel rather than one at a time.</p>
</div>
<div class="section" id="profile">
<span id="sim-profile"></span><h3>profile<a class="headerlink" href="#profile" title="Permalink to this headline">¶</a></h3>
<p>If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, profiling data will be collected while the simulation
runs.  This will significantly slow down the simulation, so it should be left
on <code class="docutils literal notranslate"><span class="pre">False</span></code> (the default) in most cases.  It is mainly used by developers,
in order to help identify performance bottlenecks.</p>
<p>Profiling data will be saved to a file named <code class="docutils literal notranslate"><span class="pre">nengo_dl_profile.json</span></code>.  It
can be viewed by opening a Chrome browser, navigating to
<a class="reference external" href="chrome://tracing">chrome://tracing</a> and loading the <code class="docutils literal notranslate"><span class="pre">nengo_dl_profile.json</span></code> file.  A
filename can be passed instead of <code class="docutils literal notranslate"><span class="pre">True</span></code>, to change the output filename.</p>
<p>Note that in order for GPU profiling to work, you need to manually add
<code class="docutils literal notranslate"><span class="pre">&lt;cuda&gt;/extras/CUPTI/libx64</span></code> to the <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> environment variable
(where <code class="docutils literal notranslate"><span class="pre">&lt;cuda&gt;</span></code> is your CUDA installation directory).</p>
</div>
</div>
</div>


            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div><footer class="text-light footer-main gradient-bottom">
  <p class="small text-center mb-0">
    <a class="no-hover-line" href="https://appliedbrainresearch.com">
      <img
        src="https://appliedbrainresearch.com/img/logo-blue-notext.svg"
        height="48"
      />
    </a>
    <a href="https://www.nengo.ai/">What is Nengo?</a>
    <a href="https://www.nengo.ai/examples/">Examples</a>
    <a href="https://www.nengo.ai/documentation/">Documentation</a>
    <a href="https://www.nengo.ai/getting-started/">Getting started</a>
    <a href="https://www.nengo.ai/privacy/">Privacy</a>
  </p>
  <p class="small text-center mb-0">&copy; Applied Brain Research</p>
</footer>
<script>
  function switchVersion(select) {
    var option = select.selectedOptions[0];
    if (option.hasAttribute("value")) {
      window.location = option.value;
    }
  }
</script>

<script>
  var elements = document.querySelectorAll('.sidenav');
  Stickyfill.add(elements);
</script>
<script>
  ScrollReveal().reveal(".fade-in", {
      scale: 0.85,
      duration: 1000,
      delay: 250,
      interval: 50
  });
</script>
<script>
  $('a.toggle-sidenav').on('click', function(e) {
    e.preventDefault();
    if ( $(this).hasClass('active') ) {
      $(this).removeClass('active');
      $('.sidenav').removeClass('open');
    } else {
      $(this).addClass('active');
      $('.sidenav').addClass('open');
    }
  });
</script>
<script>
  var lists = document.querySelectorAll('.toctree ul');
  lists.forEach((ul) => {
      ul.classList.add("nav");
  });
  var links = document.querySelectorAll('.toctree a');
  links.forEach((link) => {
      link.classList.add("nav-link");
  });
  $("body").scrollspy({target: ".sidenav"});
</script>
  </body>
</html>