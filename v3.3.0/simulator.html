
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>NengoDL Simulator &#8212; NengoDL 3.3.0 docs</title>
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,400i,600|Rajdhani:700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.nengo.ai/css/bootstrap.css" type="text/css">
<style>
  body .title-bar,
  body .documentation-source h1:after {
    background-color: #ff6600;
  }
</style>

<!-- Google Tag Manager -->
<script>
 (function (w, d, s, l, i) {
   w[l] = w[l] || [];
   w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
   var f = d.getElementsByTagName(s)[0],
       j = d.createElement(s),
       dl = l != "dataLayer" ? "&l=" + l : "";
   j.async = true;
   j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
   f.parentNode.insertBefore(j, f);
 })(window, document, "script", "dataLayer", "GTM-KWCR2HN");
</script>
<!-- End Google Tag Manager -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://unpkg.com/scrollreveal"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<!-- From basic/layout.html -->
<script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
  
  
<script src="_static/underscore.js"></script>
  
  
<script src="_static/doctools.js"></script>
  
  
<script src="_static/language_data.js"></script>
  
  
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
  
  
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TensorNodes" href="tensor-node.html" />
    <link rel="prev" title="User guide" href="user-guide.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  </head><body class="bg-dark">

<header class="fixed-top header-top shadow-sm">
  <nav class="navbar navbar-expand-md navbar-light bg-white">
    <a class="navbar-brand" href="https://www.nengo.ai/">
      <img
        src="https://www.nengo.ai/design/_images/general-full-light.svg"
        alt="Nengo"
        class="logo"
      />
    </a>
    <button
      class="navbar-toggler"
      type="button"
      data-toggle="collapse"
      data-target="#navbar-collapse"
      aria-controls="navbar-collapse"
      aria-expanded="false"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/">What is Nengo?</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.nengo.ai/examples/">Examples</a>
        </li>
        <li class="nav-item dropdown active">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-docs"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Documentation</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-docs"
          >
            
            <a class="dropdown-item" href="https://www.nengo.ai/nengo/">Nengo Core</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-gui/">Nengo GUI</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-dl/">Nengo DL</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-spa/">Nengo SPA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-extras/">Nengo Extras</a>
            <a class="dropdown-item" href="https://arvoelke.github.io/nengolib-docs/">Nengolib</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-fpga/">Nengo FPGA</a>
            <a class="dropdown-item" href="https://www.nengo.ai/nengo-loihi/">Nengo Loihi</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-ocl">Nengo OpenCL</a>
            <a class="dropdown-item" href="https://github.com/project-rig/nengo_spinnaker">Nengo SpiNNaker</a>
            <a class="dropdown-item" href="https://github.com/nengo/nengo-mpi">Nengo MPI</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/documentation/"
              >All documentation</a
            >
          </div>
        </li>
        <li class="nav-item dropdown">
          <a
            class="nav-link dropdown-toggle"
            id="navbar-dropdown-community"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            href="#"
            >Community</a
          >
          <div
            class="dropdown-menu shadow-lg border-0"
            aria-labelledby="navbar-dropdown-community"
          >
            <a class="dropdown-item" href="https://forum.nengo.ai">Forum</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="https://www.nengo.ai/people/"
              >People</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/summer-school/"
              >Summer school</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/contributing/"
              >Contributing</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/publications/"
              >Publications</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/videos/"
              >Videos</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/conduct/"
              >Code of conduct</a
            >
            <a class="dropdown-item" href="https://www.nengo.ai/caa/">CAA</a>
          </div>
        </li>
        <li class="nav-item">
          <a
            class="nav-link btn btn-success btn-sm text-white"
            href="https://www.nengo.ai/getting-started/"
            >Getting started</a
          >
        </li>
      </ul>
    </div>
  </nav>
</header>
<div class="main-content gradient-top">
  <div class="container-fluid">
    <div class="row"><a class="toggle-sidenav d-block d-md-none" href="#"
  ><i class="icon-close fa fa-fw fa-arrow-left"></i
  ><i class="icon-open fa fa-fw fa-arrow-right"></i
></a>
<div role="complementary" class="sidenav col-4 col-xl-3 p-0 border-right">
  <h3 class="pt-5 px-5">
    <a href="index.html">
      <img
        class="img-fluid documentation-image"
        src="https://www.nengo.ai/design/_images/nengo-dl-full-light.svg"
        alt="NengoDL"
      />
    </a>
  </h3>
<form class="px-5 py-3 my-0 border-bottom" action="search.html" method="get">
  <div class="form-group form-group-single">
    <input type="text" name="q" class="form-control" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <button type="submit" class="btn btn-link">
      <img src="https://www.nengo.ai/img/icon-search.svg" alt="Go" />
    </button>
  </div>
</form><div class="p-5 toctree">
  
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user-guide.html">User guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">NengoDL Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#keras-integration">Keras integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#choosing-which-elements-to-optimize">Choosing which elements to optimize</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saving-and-loading-parameters">Saving and loading parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tensor-node.html">TensorNodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="converter.html">Converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Configuration options</a></li>
<li class="toctree-l2"><a class="reference internal" href="tips.html">Tips and tricks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Additional resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project information</a></li>
</ul>

  
  </div>
  
  <form class="p-5 my-0 border-top">
    <div class="form-group">
      <label class="text-gray">Version:</label>
      <select class="custom-select" onchange="switchVersion(this);">
        
        
        <option value="../simulator.html">latest</option>
        
        
          
        <option selected>v3.3.0</option>
          
        
          
        <option value="../v3.2.0/simulator.html">
          v3.2.0
        </option>
          
        
          
        <option value="../v3.1.0/simulator.html">
          v3.1.0
        </option>
          
        
          
        <option value="../v3.0.0/simulator.html">
          v3.0.0
        </option>
          
        
          
        <option value="../v2.2.2/simulator.html">
          v2.2.2
        </option>
          
        
          
        <option value="../v2.2.1/simulator.html">
          v2.2.1
        </option>
          
        
          
        <option value="../v2.2.0/simulator.html">
          v2.2.0
        </option>
          
        
          
        <option value="../v2.1.1/simulator.html">
          v2.1.1
        </option>
          
        
          
        <option value="../v2.1.0/simulator.html">
          v2.1.0
        </option>
          
        
          
        <option value="../v2.0.0/simulator.html">
          v2.0.0
        </option>
          
        
          
        <option value="../v1.2.1/simulator.html">
          v1.2.1
        </option>
          
        
          
        <option value="../v1.2.0/simulator.html">
          v1.2.0
        </option>
          
        
          
        <option value="../v1.1.0/simulator.html">
          v1.1.0
        </option>
          
        
          
        <option value="../v1.0.0/simulator.html">
          v1.0.0
        </option>
          
        
          
        <option value="../v0.6.2/simulator.html">
          v0.6.2
        </option>
          
        
          
        <option value="../v0.6.1/simulator.html">
          v0.6.1
        </option>
          
        
          
        <option value="../v0.6.0/simulator.html">
          v0.6.0
        </option>
          
        
          
        <option value="../v0.5.2/simulator.html">
          v0.5.2
        </option>
          
        
          
        <option value="../v0.5.1/simulator.html">
          v0.5.1
        </option>
          
        
          
        <option value="../v0.5.0/simulator.html">
          v0.5.0
        </option>
          
        
          
        <option value="../v0.4.0/simulator.html">
          v0.4.0
        </option>
          
        
          
        <option value="../v0.3.1/simulator.html">
          v0.3.1
        </option>
          
        
          
        <option value="../v0.3.0/simulator.html">
          v0.3.0
        </option>
          
        
          
        <option value="../v0.2.0/simulator.html">
          v0.2.0
        </option>
          
        
      </select>
    </div>
  </form>
  
</div>
      

      <div class="col-12 col-md-8 col-xl-9">
        <div class="container">
          <div class="row">
            <div class="col-10 offset-1 pb-5 documentation-source" role="main">
              
  <div class="section" id="nengodl-simulator">
<h1>NengoDL Simulator<a class="headerlink" href="#nengodl-simulator" title="Permalink to this headline">¶</a></h1>
<p>This is the class that allows users to access the <code class="docutils literal notranslate"><span class="pre">nengo_dl</span></code>
backend.  This can be used as a drop-in replacement for <code class="docutils literal notranslate"><span class="pre">nengo.Simulator</span></code>
(i.e., simply replace any instance of <code class="docutils literal notranslate"><span class="pre">nengo.Simulator</span></code> with
<code class="docutils literal notranslate"><span class="pre">nengo_dl.Simulator</span></code> and everything will continue to function as
normal).</p>
<p>In addition, the Simulator exposes features unique to the
NengoDL backend.  In many cases these features are accessed through something very
similar to the <a class="reference external" href="https://www.tensorflow.org/guide/keras/train_and_evaluate">Keras API</a>,
which will be familiar to many deep learning practitioners.  For example,
the Simulator has <a class="reference internal" href="reference.html#nengo_dl.Simulator.predict" title="nengo_dl.Simulator.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>, <a class="reference internal" href="reference.html#nengo_dl.Simulator.fit" title="nengo_dl.Simulator.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>, <a class="reference internal" href="reference.html#nengo_dl.Simulator.compile" title="nengo_dl.Simulator.compile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code></a>, and
<a class="reference internal" href="reference.html#nengo_dl.Simulator.evaluate" title="nengo_dl.Simulator.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a> functions, which work in the same way as the corresponding
functions of a <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/Model">Keras Model</a>.</p>
<p>The full class documentation can be viewed in the
<a class="reference internal" href="reference.html#sim-api"><span class="std std-ref">API Reference</span></a>.</p>
<div class="section" id="keras-integration">
<h2>Keras integration<a class="headerlink" href="#keras-integration" title="Permalink to this headline">¶</a></h2>
<p>Under the hood, the NengoDL Simulator is using a Keras model to perform the simulation.
That means that most things that you would do with a Keras Model
will also work with a NengoDL Simulator.  For example, you can set up a complex
input pipeline using <a class="reference external" href="https://www.tensorflow.org/guide/data">tf.data</a>, and feed those
inputs to the Nengo model through <a class="reference internal" href="reference.html#nengo_dl.Simulator.predict" title="nengo_dl.Simulator.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator.predict</span></code></a>. Or you could follow all the
steps in <a class="reference external" href="https://www.tensorflow.org/tensorboard/get_started">this TensorBoard tutorial</a>
(simply replacing the Keras Model with a NengoDL Simulator) in order to view training
metrics from <a class="reference internal" href="reference.html#nengo_dl.Simulator.fit" title="nengo_dl.Simulator.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Simulator.fit</span></code></a> in TensorBoard.</p>
<p>In general, if you are wondering how to access some functionality in NengoDL, look up
how you would do that thing in Keras, and it probably works the same way! If you find
something that works in Keras but not NengoDL, consider
<a class="reference external" href="https://forum.nengo.ai/">asking a question on the forums</a> or
<a class="reference external" href="https://github.com/nengo/nengo-dl/issues">opening a feature request</a>.</p>
</div>
<div class="section" id="choosing-which-elements-to-optimize">
<h2>Choosing which elements to optimize<a class="headerlink" href="#choosing-which-elements-to-optimize" title="Permalink to this headline">¶</a></h2>
<p>By default, NengoDL will optimize the following elements in a model:</p>
<ol class="arabic simple">
<li><p>Connection weights (neuron–neuron weight matrices or decoders)</p></li>
<li><p>Ensemble encoders</p></li>
<li><p>Neuron biases</p></li>
</ol>
<p>These elements will <em>not</em> be optimized if they are targeted by an online
learning rule.  For example, <a class="reference external" href="https://www.nengo.ai/nengo/frontend-api.html#nengo.PES" title="(in Nengo v3.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nengo.PES</span></code></a> modifies connection
weights as a model is running.  If we also tried to optimize those weights with
some offline training method then those two processes would conflict
with each other, likely resulting in unintended effects.  So NengoDL will
assume that those elements should not be optimized.</p>
<p>Any of these default behaviours can be overridden using the
<a class="reference internal" href="config.html#config-trainable"><span class="std std-ref">“trainable” config option</span></a>.</p>
</div>
<div class="section" id="saving-and-loading-parameters">
<h2>Saving and loading parameters<a class="headerlink" href="#saving-and-loading-parameters" title="Permalink to this headline">¶</a></h2>
<p>After optimizing a model we often want to do something with the trained
parameters (e.g., inspect their values, save them to file, reuse them in a
different model).  NengoDL provides a number of methods to access model
parameters, in order to support different use cases.</p>
<div class="section" id="sim-data">
<h3>sim.data<a class="headerlink" href="#sim-data" title="Permalink to this headline">¶</a></h3>
<p>The most basic way to access model parameters is through the
<a class="reference internal" href="reference.html#nengo_dl.simulator.SimulationData" title="nengo_dl.simulator.SimulationData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sim.data</span></code></a>
data structure.  This provides access to the parameters of any Nengo object,
returning them as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays.  For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Network</span><span class="p">()</span> <span class="k">as</span> <span class="n">net</span><span class="p">:</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Node</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ens</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Ensemble</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">ens</span><span class="p">)</span>
    <span class="n">probe</span> <span class="o">=</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Probe</span><span class="p">(</span><span class="n">ens</span><span class="p">)</span>

<span class="k">with</span> <span class="n">nengo_dl</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="c1"># &lt; run training &gt;</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">conn</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>  <span class="c1"># connection weights</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ens</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>  <span class="c1"># bias values</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ens</span><span class="p">]</span><span class="o">.</span><span class="n">encoders</span><span class="p">)</span>  <span class="c1"># encoder values</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ens</span><span class="p">])</span>  <span class="c1"># to see all the parameters for an object</span>
</pre></div>
</div>
<p>Once we have the parameters as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays we can then do whatever
we want with them (e.g., save them to file, or use them as arguments in a
different model).  Thus this method is the most general and flexible, but also
somewhat labour intensive as the user needs to handle all of that processing
themselves for each parameter.</p>
</div>
<div class="section" id="sim-save-params-sim-load-params">
<h3>sim.save_params/sim.load_params<a class="headerlink" href="#sim-save-params-sim-load-params" title="Permalink to this headline">¶</a></h3>
<p>On the opposite end of the spectrum, <a class="reference internal" href="reference.html#nengo_dl.Simulator.save_params" title="nengo_dl.Simulator.save_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_params</span></code></a>/
<a class="reference internal" href="reference.html#nengo_dl.Simulator.load_params" title="nengo_dl.Simulator.load_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_params</span></code></a> can be used to save all the parameters of a
model to file.  This is
convenient if we want to save and resume the state of a model (e.g., run some
training, do some analysis, and then run more training):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">nengo_dl</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="c1"># &lt; run training &gt;</span>

    <span class="n">sim</span><span class="o">.</span><span class="n">save_params</span><span class="p">(</span><span class="s2">&quot;./my_saved_params&quot;</span><span class="p">)</span>

<span class="c1"># &lt; do something else &gt;</span>

<span class="k">with</span> <span class="n">nengo_dl</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim2</span><span class="p">:</span>
    <span class="n">sim2</span><span class="o">.</span><span class="n">load_params</span><span class="p">(</span><span class="s2">&quot;./my_saved_params&quot;</span><span class="p">)</span>
    <span class="c1"># sim2 will now match the parameters from sim</span>
</pre></div>
</div>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">save/load_params</span></code> to reuse parameters between models, as
long as the structure of the two models match exactly (for example,
reusing parameters from a rate version of a model in a spiking version).</p>
<p>This method is quick and convenient, but not as flexible as other options.</p>
</div>
<div class="section" id="sim-freeze-params">
<h3>sim.freeze_params<a class="headerlink" href="#sim-freeze-params" title="Permalink to this headline">¶</a></h3>
<p>Rather than saving model parameters to file,
we can store live parameters back into the model definition using
<a class="reference internal" href="reference.html#nengo_dl.Simulator.freeze_params" title="nengo_dl.Simulator.freeze_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze_params</span></code></a>.  We can freeze the parameters of individual
Ensembles and Connections, or pass a Network to freeze all the Ensembles and
Connections in that Network.</p>
<p>The main advantage of this approach is
that it makes it easy to reuse a NengoDL model in different Nengo simulators.
For example, we could optimize a model in NengoDL, save the result as a
Nengo network, and then run that model in another Simulator (e.g., one running
on custom neuromorphic hardware).</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">nengo_dl</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim</span><span class="p">:</span>
    <span class="c1"># &lt; run training &gt;</span>

    <span class="n">sim</span><span class="o">.</span><span class="n">freeze_params</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>

<span class="c1"># load our optimized network in a different simulator</span>
<span class="k">with</span> <span class="n">nengo</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">net</span><span class="p">)</span> <span class="k">as</span> <span class="n">sim2</span><span class="p">:</span>
    <span class="c1"># sim2 will now simulate a model in the default Nengo simulator, but</span>
    <span class="c1"># with the same parameters as our optimized Nengo DL model</span>
    <span class="n">sim2</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="examples/from-nengo.html"><span class="doc">Coming from Nengo to NengoDL</span></a></p></li>
<li><p><a class="reference internal" href="examples/from-tensorflow.html"><span class="doc">Coming from TensorFlow to NengoDL</span></a></p></li>
<li><p><a class="reference internal" href="examples/spiking-mnist.html"><span class="doc">Optimizing a spiking neural network</span></a></p></li>
</ul>
</div>
</div>


            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div><footer class="text-light footer-main gradient-bottom">
  <p class="small text-center mb-0">
    <a class="no-hover-line" href="https://appliedbrainresearch.com">
      <img
        src="https://appliedbrainresearch.com/img/logo-blue-notext.svg"
        height="48"
      />
    </a>
    <a href="https://www.nengo.ai/">What is Nengo?</a>
    <a href="https://www.nengo.ai/examples/">Examples</a>
    <a href="https://www.nengo.ai/documentation/">Documentation</a>
    <a href="https://www.nengo.ai/getting-started/">Getting started</a>
    <a href="https://www.nengo.ai/privacy/">Privacy</a>
  </p>
  <p class="small text-center mb-0">&copy; Applied Brain Research</p>
</footer>
<script>
  function switchVersion(select) {
    var option = select.selectedOptions[0];
    if (option.hasAttribute("value")) {
      window.location = option.value;
    }
  }
</script>

<script>
  var elements = document.querySelectorAll('.sidenav');
  Stickyfill.add(elements);
</script>
<script>
  ScrollReveal().reveal(".fade-in", {
      scale: 0.85,
      duration: 1000,
      delay: 250,
      interval: 50
  });
</script>
<script>
  $('a.toggle-sidenav').on('click', function(e) {
    e.preventDefault();
    if ( $(this).hasClass('active') ) {
      $(this).removeClass('active');
      $('.sidenav').removeClass('open');
    } else {
      $(this).addClass('active');
      $('.sidenav').addClass('open');
    }
  });
</script>
<script>
  var lists = document.querySelectorAll('.toctree ul');
  lists.forEach((ul) => {
      ul.classList.add("nav");
  });
  var links = document.querySelectorAll('.toctree a');
  links.forEach((link) => {
      link.classList.add("nav-link");
  });
  $("body").scrollspy({target: ".sidenav"});
</script>
  </body>
</html>