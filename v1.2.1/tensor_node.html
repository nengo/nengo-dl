

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TensorNodes &mdash; NengoDL documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configuration system" href="config.html" />
    <link rel="prev" title="Optimizing a NengoDL model" href="training.html" /> 

  

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GT8XEDLTMJ"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-GT8XEDLTMJ');
</script>
<!-- End Google tag (gtag.js) -->

<!-- Matomo -->
<script>
 var _paq = window._paq = window._paq || [];
 _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
 _paq.push(["setCookieDomain", "*.appliedbrainresearch.com"]);
 _paq.push(["setDomains", ["*.appliedbrainresearch.com","*.edge.nengo.ai","*.forum.nengo.ai","*.labs.nengo.ai","*.nengo.ai"]]);
 _paq.push(["enableCrossDomainLinking"]);
 _paq.push(["setDoNotTrack", true]);
 _paq.push(['trackPageView']);
 _paq.push(['enableLinkTracking']);
 (function() {
   var u="https://appliedbrainresearch.matomo.cloud/";
   _paq.push(['setTrackerUrl', u+'matomo.php']);
   _paq.push(['setSiteId', '3']);
   var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
   g.async=true; g.src='//cdn.matomo.cloud/appliedbrainresearch.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
 })();
</script>
<!-- End Matomo Code -->
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> NengoDL
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="frontend.html">User documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="simulator.html">NengoDL Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="training.html">Optimizing a NengoDL model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TensorNodes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Configuration system</a></li>
<li class="toctree-l2"><a class="reference internal" href="extra_objects.html">Extra Nengo objects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">Additional resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend.html">Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html">Project information</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NengoDL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="frontend.html">User documentation</a> &raquo;</li>
        
      <li>TensorNodes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tensor_node.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="tensornodes">
<h1>TensorNodes<a class="headerlink" href="#tensornodes" title="Permalink to this headline">¶</a></h1>
<p>TensorNodes allow parts of a model to be defined using TensorFlow and smoothly
integrated with the rest of a Nengo model.  TensorNodes work very similarly to
a regular <a class="reference external" href="https://www.nengo.ai/nengo/frontend_api.html#nengo.Node" title="(in Nengo v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>, except instead of executing arbitrary
Python code they execute arbitrary TensorFlow code.</p>
<p><a class="reference internal" href="#nengo_dl.tensor_node.tensor_layer" title="nengo_dl.tensor_node.tensor_layer"><code class="xref py py-func docutils literal notranslate"><span class="pre">tensor_layer()</span></code></a> is a utility function for constructing TensorNodes,
designed to mimic the layer-based model construction style of many deep
learning packages.</p>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="examples/pretrained_model.html"><span class="doc">Inserting a TensorFlow network into a Nengo model</span></a></li>
<li><a class="reference internal" href="examples/spiking_mnist.html"><span class="doc">Optimizing spiking neural networks</span></a></li>
</ul>
</div>
<div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="nengo_dl.tensor_node.TensorNode">
<em class="property">class </em><code class="descclassname">nengo_dl.tensor_node.</code><code class="descname">TensorNode</code><span class="sig-paren">(</span><em>tensor_func</em>, <em>size_in=Default</em>, <em>size_out=Default</em>, <em>label=Default</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_node.html#TensorNode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_node.TensorNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts TensorFlow code into a Nengo model.  A TensorNode operates in
much the same way as a <a class="reference external" href="https://www.nengo.ai/nengo/frontend_api.html#nengo.Node" title="(in Nengo v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a>, except its inputs and
outputs are defined using TensorFlow operations.</p>
<p>The TensorFlow code is defined in a function or callable class
(<code class="docutils literal notranslate"><span class="pre">tensor_func</span></code>).  This function accepts the current simulation time as
input, or the current simulation time and a Tensor <code class="docutils literal notranslate"><span class="pre">x</span></code> if
<code class="docutils literal notranslate"><span class="pre">node.size_in</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>.  <code class="docutils literal notranslate"><span class="pre">x</span></code> will have shape
<code class="docutils literal notranslate"><span class="pre">(sim.minibatch_size,</span> <span class="pre">node.size_in</span></code>), and the function should return a
Tensor with shape <code class="docutils literal notranslate"><span class="pre">(sim.minibatch_size,</span> <span class="pre">node.size_out)</span></code>.
<code class="docutils literal notranslate"><span class="pre">node.size_out</span></code> will be inferred by calling the function once and
checking the output, if it isn’t set when the Node is created.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">tensor_func</span></code> has a <code class="docutils literal notranslate"><span class="pre">pre_build</span></code> attribute, that function will be
called once when the model is constructed.  This can be used to compute any
constant values or set up variables – things that don’t need to
execute every simulation timestep.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pre_build</span><span class="p">(</span><span class="n">shape_in</span><span class="p">,</span> <span class="n">shape_out</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">shape_in</span><span class="p">)</span>  <span class="c1"># (minibatch_size, node.size_in)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">shape_out</span><span class="p">)</span>  <span class="c1"># (minibatch_size, node.size_out)</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">tensor_func</span></code> has a <code class="docutils literal notranslate"><span class="pre">post_build</span></code> attribute, that function will be
called after the simulator is created and whenever it is reset.  This can
be used to set any random elements in the TensorNode or perform any
post-initialization setup required by the node (e.g., loading pretrained
weights).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">post_build</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="n">rng</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">)</span>  <span class="c1"># the TensorFlow simulation session object</span>
    <span class="k">print</span><span class="p">(</span><span class="n">rng</span><span class="p">)</span>  <span class="c1"># random number generator (np.random.RandomState)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tensor_func</strong> <span class="classifier-delimiter">:</span> <span class="classifier">callable</span></dt>
<dd><p class="first last">A function that maps node inputs to outputs</p>
</dd>
<dt><strong>size_in</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional (Default: 0)</span></dt>
<dd><p class="first last">The number of elements in the input vector</p>
</dd>
<dt><strong>size_out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional (Default: None)</span></dt>
<dd><p class="first last">The number of elements in the output vector (if None, value will be
inferred by calling <code class="docutils literal notranslate"><span class="pre">tensor_func</span></code>)</p>
</dd>
<dt><strong>label</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional (Default: None)</span></dt>
<dd><p class="first last">A name for the node, used for debugging and visualization</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nengo_dl.tensor_node.tensor_layer">
<code class="descclassname">nengo_dl.tensor_node.</code><code class="descname">tensor_layer</code><span class="sig-paren">(</span><em>input</em>, <em>layer_func</em>, <em>shape_in=None</em>, <em>synapse=None</em>, <em>transform=1</em>, <em>return_conn=False</em>, <em>**layer_args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nengo_dl/tensor_node.html#tensor_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nengo_dl.tensor_node.tensor_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>A utility function to construct TensorNodes that apply some function
to their input (analogous to the <code class="docutils literal notranslate"><span class="pre">tf.layers</span></code> syntax).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>input</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="docutils literal notranslate"><span class="pre">NengoObject</span></code></span></dt>
<dd><p class="first last">Object providing input to the layer</p>
</dd>
<dt><strong>layer_func</strong> <span class="classifier-delimiter">:</span> <span class="classifier">callable or <a class="reference external" href="https://www.nengo.ai/nengo/frontend_api.html#nengo.neurons.NeuronType" title="(in Nengo v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronType</span></code></a></span></dt>
<dd><p class="first last">A function that takes the value from <code class="docutils literal notranslate"><span class="pre">input</span></code> (represented as a
<code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code>) and maps it to some output value, or a Nengo neuron
type, defining a nonlinearity that will be applied to <code class="docutils literal notranslate"><span class="pre">input</span></code>.</p>
</dd>
<dt><strong>shape_in</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple of int, optional</span></dt>
<dd><p class="first last">If not None, reshape the input to the given shape</p>
</dd>
<dt><strong>synapse</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or <a class="reference external" href="https://www.nengo.ai/nengo/frontend_api.html#nengo.synapses.Synapse" title="(in Nengo v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Synapse</span></code></a>, optional</span></dt>
<dd><p class="first last">Synapse to apply on connection from <code class="docutils literal notranslate"><span class="pre">input</span></code> to this layer</p>
</dd>
<dt><strong>transform</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, optional</span></dt>
<dd><p class="first last">Transform matrix to apply on connection from <code class="docutils literal notranslate"><span class="pre">input</span></code> to this layer</p>
</dd>
<dt><strong>return_conn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, also return the connection linking this layer to <code class="docutils literal notranslate"><span class="pre">input</span></code></p>
</dd>
<dt><strong>layer_args</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict, optional</span></dt>
<dd><p class="first last">These arguments will be passed to <code class="docutils literal notranslate"><span class="pre">layer_func</span></code> if it is callable, or
<a class="reference external" href="https://www.nengo.ai/nengo/frontend_api.html#nengo.Ensemble" title="(in Nengo v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code></a> if <code class="docutils literal notranslate"><span class="pre">layer_func</span></code> is a
<a class="reference external" href="https://www.nengo.ai/nengo/frontend_api.html#nengo.neurons.NeuronType" title="(in Nengo v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuronType</span></code></a></p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>:class:`.TensorNode` or :class:`~nengo:nengo.ensemble.Neurons`</strong></dt>
<dd><p class="first last">A TensorNode that implements the given layer function (if
<code class="docutils literal notranslate"><span class="pre">layer_func</span></code> was a callable), or a Neuron object with the given
neuron type, connected to <code class="docutils literal notranslate"><span class="pre">input</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="config.html" class="btn btn-neutral float-right" title="Configuration system" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="training.html" class="btn btn-neutral" title="Optimizing a NengoDL model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, Applied Brain Research
      Last updated on Nov 02, 2018.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  <!-- adapted from sphinx_rtd_theme versions.html -->

<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Versions</span>
        v1.2.1
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            
            
                <dd><a href="../tensor_node.html">latest</a></dd>
            

            
                
                    <dd>v1.2.1</dd>
                
            
                
                    <dd><a href="../v1.2.0/tensor_node.html">v1.2.0</a></dd>
                
            
                
                    <dd><a href="../v1.1.0/tensor_node.html">v1.1.0</a></dd>
                
            
                
                    <dd><a href="../v1.0.0/tensor_node.html">v1.0.0</a></dd>
                
            
                
                    <dd><a href="../v0.6.2/tensor_node.html">v0.6.2</a></dd>
                
            
                
                    <dd><a href="../v0.6.1/tensor_node.html">v0.6.1</a></dd>
                
            
                
                    <dd><a href="../v0.6.0/tensor_node.html">v0.6.0</a></dd>
                
            
                
                    <dd><a href="../v0.5.2/tensor_node.html">v0.5.2</a></dd>
                
            
                
                    <dd><a href="../v0.5.1/tensor_node.html">v0.5.1</a></dd>
                
            
                
                    <dd><a href="../v0.5.0/tensor_node.html">v0.5.0</a></dd>
                
            
                
                    <dd><a href="../v0.4.0/tensor_node.html">v0.4.0</a></dd>
                
            
                
                    <dd><a href="../v0.3.1/tensor_node.html">v0.3.1</a></dd>
                
            
                
                    <dd><a href="../v0.3.0/tensor_node.html">v0.3.0</a></dd>
                
            
                
                    <dd><a href="../v0.2.0/tensor_node.html">v0.2.0</a></dd>
                
            
        </dl>
    </div>
</div>

  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>